import test.assert_eq

####### Assigning to map entries

x =
  foo: 0
  bar:
    baz: -1
y = copy x
z = copy x.bar

assert_eq x.foo 0
x.foo = "^_^"
assert_eq x.foo "^_^"
assert_eq x.bar.baz -1
x.bar.baz = [1 2 3]
assert_eq x.bar.baz [1 2 3]

# y and z haven't been modified
assert_eq y {foo: 0, bar: {baz: -1}}
assert_eq z {baz: -1}

# New entries can be added
x.new = "O_o"
assert_eq (map.keys x) ["foo" "bar" "new"]
x.bar.new = ">_<"
assert_eq (map.keys x.bar) ["baz" "new"]

# Maps can be nested deeply
deep = {a: {b: {c: {d: {e: {f: 42}}}}}}
assert_eq deep.a.b.c.d.e.f 42
deep.a.b.c.d.e.f = 99
assert_eq deep.a.b.c.d.e.f 99

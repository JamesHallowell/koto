import test.assert_eq

export tests =
  test_collect: ||
    assert_eq (1..=3).iter().collect() [1 2 3]
    assert_eq [2 4 6].iter().collect() [2 4 6]
    assert_eq {foo: 42, bar: 99}.iter().collect() [["foo" 42] ["bar" 99]]
    doubler = |xs|
      for x in xs
        yield x * 2
    assert_eq (doubler 1..=5).collect() [2 4 6 8 10]

  test_take: ||
    assert_eq (1..100).iter().take(5).collect() [1 2 3 4 5]
    ones = ||
      loop
        yield 1
    assert_eq ones().take(3).collect() [1 1 1]

  test_transform: ||
    assert_eq ["1" "2"].iter().transform(|x| x.to_number()).collect() [1 2]
    x = {foo: 42, bar: 99}.iter().transform(|key value| [key value])
    assert_eq x.collect() [["foo" 42] ["bar" 99]]
